[
    {
        "block": {
            "lang": "python",
            "code": [
                "if __name__ == \"__main__\":",
                "    clean_up_loop = False",
                "    loop = asyncio.get_event_loop()",
                "    try:",
                "        loop.run_until_complete(run())",
                "    except Exception:",
                "        clean_up_loop = True",
                "        pass",
                "    finally:",
                "        async def close_sessions_and_consumers():",
                "            for k in kafka.CONSUMERS:",
                "                await k.stop()",
                "            await kafka.SESSION.close()",
                "        loop.run_until_complete(close_sessions_and_consumers())",
                "        if clean_up_loop:",
                "            pending = asyncio.all_tasks()",
                "            for task in pending:",
                "                task.cancel()",
                "            loop.run_until_complete(asyncio.gather(*pending, return_exceptions=True))",
                "            loop.stop()",
                "            loop.close()"
            ]
        },
        "other": []
    },
    {
        "block": {
            "lang": "golang",
            "code": [
                "(func(args... interface{}){})(scrape_cpu, scrape_hostname)"
            ]
        },
        "other": [
            "go",
            "bypass unused function error"
        ]
    },
    {
        "block": {
            "lang": "golang",
            "code": [
                "go fmt ./..."
            ]
        },
        "other": [
            "go",
            "go fmt on current directory go files and all subdirectories"
        ]
    },
    {
        "block": {
            "lang": "golang",
            "code": [
                "type Person struct {",
                "  Name string",
                "}",
                "func (p *Person) Talk() {",
                "  fmt.Println(\"Hi, my name is\", p.Name)",
                "}",
                "type Android struct {",
                "  Person // Android is also type Person!",
                "  Model string",
                "}",
                "a := new(Android)",
                "a.Person.Talk()",
                "a.Talk() // polymorphism!"
            ]
        },
        "other": [
            "go",
            "embedded types"
        ]
    },
    {
        "block": {
            "lang": "golang",
            "code": []
        },
        "other": [
            "go",
            "mutex classes",
            "  sync.RWLock()",
            "  sync.Once"
        ]
    },
    {
        "block": {
            "lang": "golang",
            "code": [
                "var Foo string",
                "// runs like package constructor",
                "func init(){",
                "    Foo = \"foobar\"",
                "}"
            ]
        },
        "other": [
            "go",
            "init function in packages"
        ]
    },
    {
        "block": {
            "lang": "golang",
            "code": [
                "func getLastLetterRecursivley(word string) {",
                "    type rFunc func(string, rFunc) // <- allows recursive function to be defined",
                "    var f rFunc = func(word string, f rFunc) {",
                "        if len(word) == 1 {",
                "            fmt.Println(\"Last character is:\", word)",
                "            return",
                "        }",
                "        f(word[len(word) - 1: ], f)",
                "        return",
                "    }",
                "    go f(x, f)",
                "    for {} // keep function running to we can still print",
                "}"
            ]
        },
        "other": [
            "go",
            "type signature for parameters of self containing recursive functions"
        ]
    },
    {
        "block": {
            "lang": "golang",
            "code": [
                "type StringOrInt interface{",
                "\tstring | int",
                "}",
                "func main() {",
                "\t{",
                "\t\tvar x = foo[int]()",
                "\t\tfmt.Println(x)",
                "\t}",
                "\t{",
                "\t\tvar x = foo[string]()",
                "\t\tfmt.Println(x)",
                "\t}",
                "\t{",
                "\t\tvar x = foo[bool]() // err",
                "\t\tfmt.Println(x)",
                "\t}",
                "}",
                "func foo[T StringOrInt]() []T {",
                "\tvar x T",
                "\treturn []T{x}",
                "}"
            ]
        },
        "other": [
            "go",
            "generics + type constraint"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "import logging",
                "fooLogger = logging.getLogget(\"foo\")",
                "def foo():",
                "    try:",
                "        raise Exception(\"foo error\")",
                "    except Exception as e:",
                "        fooLogger.exception(e)"
            ]
        },
        "other": [
            "python",
            "log an exception with traceback"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "try:",
                "    foo()",
                "except (Exception, KeyboardInterrupt) as e:",
                "    if isinstance(e, KeyboardInterrupt):",
                "        print('KeyboardInterrupt')",
                "    else:",
                "        pass"
            ]
        },
        "other": [
            "python",
            "catch multiple class of exceptions in one block"
        ]
    },
    {
        "block": {
            "lang": "k8",
            "code": []
        },
        "other": [
            "k8",
            "set `imagePullPolicy` to `Always`, then delete the pod, to easily update the pod with a newer image"
        ]
    },
    {
        "block": {
            "lang": "ts",
            "code": [
                "{",
                "    \"compilerOptions\": {",
                "        \"target\": \"ES2017\",",
                "        \"module\": \"ES6\",",
                "        \"outDir\": \".\", // <- creates JS for all TS in the pwd",
                "        \"rootDir\": \".\",",
                "        \"sourceMap\": false,",
                "        \"noEmit\": false",
                "    }",
                "}",
                "// order.ts",
                "import { create_toast, show_toast } from \"./utils.js\"  // <- use \".js\" instead of no extension like normal ts modules",
                "...",
                "// util.ts",
                "document.addEventListener(\"DOMContentLoaded\", function (e) {  // <- this works just fine!",
                "    // blah blah",
                "});"
            ]
        },
        "other": [
            "ts",
            "better tsc config options for writing ts files to be used as js for the browser"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "from typing import List",
                "class Foo()",
                "    static_field: List[int] = []",
                "    def __init__(self, i: int):",
                "        self.static_field.append(i)",
                "    ",
                "    def getList(self) -> List[int]:",
                "        return self.static_field",
                "a = Foo(1)",
                "b = Foo(999)",
                "print (a.getList())",
                "print (b.getList())",
                "'''",
                "[1, 999]",
                "[1, 999]",
                "'''"
            ]
        },
        "other": [
            "python",
            "shared class field across all object instances"
        ]
    },
    {
        "block": {
            "lang": "typescript",
            "code": [
                "/***",
                "app/",
                "    - tsconfig.json",
                "    src/",
                "        - index.ts",
                "        - front/",
                "            - tsconfig.json",
                "            - foo.ts",
                "***/",
                "// app/src/tsconfig.json",
                "{",
                "    \"compilerOptions\": {",
                "        \"noEmit\": true",
                "    },",
                "    \"include\": [\"./src/**/*.ts\"],",
                "    \"exclude\": [\"**/node_modules/*\", \"./src/front/**/*\"]",
                "}",
                "// app/src/front/tsconfig.json",
                "{",
                "    \"compilerOptions\": {",
                "        \"noEmit\": false",
                "    },",
                "    \"include\": [\"*.ts\"],",
                "    \"exclude\": [] // <- this was important!",
                "}",
                "// tsc with build option from /app/",
                "tsc -b . ./src/front"
            ]
        },
        "other": [
            "https://gist.github.com/khansgithub/c7a6bfca57631a4c45e2c75b7b5f881e#transpile-multile-ts-files",
            "ts",
            "transpile multile ts files"
        ]
    },
    {
        "block": {
            "lang": "node",
            "code": []
        },
        "other": [
            "node",
            "`fs.readdir` is NOT blocking; use `fs.readdirSync` instead"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": []
        },
        "other": [
            "python",
            "`__post_init__` for dataclasses",
            "https://testdriven.io/tips/94ca0d2c-4c0d-4b8f-9762-6daa11d504f7/"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "from functools import singledispatch",
                "@singledispatch",
                "def func(arg):",
                "    print(f\"Default: {arg}\")",
                "@func.register(int)",
                "def _(arg):",
                "    print(f\"Integer: {arg}\")",
                "@func.register(str)",
                "def _(arg):",
                "    print(f\"String: {arg}\")",
                "func(1)        # Output: Integer: 1",
                "func('hello')  # Output: String: hello"
            ]
        },
        "other": [
            "python",
            "function overload. `functools.singledispatch` only dispatches on the type of the first argument."
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "interface[\"name\"].startswith((\"ge\", \"xe\", \"ae\", \"et\"))"
            ]
        },
        "other": [
            "python",
            "`str.startswith` and `str.endswith` can take a `Tuple` as a parameter (https://docs.python.org/3/library/stdtypes.html#str.startswith)"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "def b():",
                "    print(\"Running function: b\")",
                "def a():",
                "    print(\"Running function: a\")",
                "def main():",
                "    return_a = a()",
                "    return_b = b()",
                "    ",
                "    print(f\"{return_a=}, {return_b=}\")",
                "@patch(\"__main__.b\")  # <- Second parameter to `mock`",
                "@patch(\"__main__.a\")  # <- First parameter to `mock`",
                "def mock(a: MagicMock, b: MagicMock,):",
                "    a.return_value = \"mocked a\"",
                "    b.return_value = \"mocked b\"",
                "    main()",
                "    ",
                "mock()",
                "'''",
                " > return_a='mocked a', return_b='mocked b'",
                "'''",
                "################",
                "@patch(\"__main__.a\")",
                "@patch(\"__main__.b\")  # <- First parameter, mismatched with naming it parameter 'a;MagicMock'",
                "def mock(a: MagicMock, b: MagicMock,):",
                "    a.return_value = \"mocked a\"",
                "    b.return_value = \"mocked b\"",
                "    main()",
                "'''",
                "> return_a='mocked b', return_b='mocked a'",
                "         ^         ^ ",
                "    mocked with wrong value",
                "'''"
            ]
        },
        "other": [
            "python",
            "decorators are applied from **bottom up**"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "logger = logging.getLogger(\"foo\")",
                "rh = RichHandler(show_level=True, show_path=True,",
                "                        markup=True, rich_tracebacks=True)",
                "logger.handlers = [rh]",
                "logger.propagate = False"
            ]
        },
        "other": [
            "python",
            "disable default console logger after adding more handlers by disabling `propagate`"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": []
        },
        "other": [
            "python",
            "preserve type inference of wrapped functions (i don't get how this works, need to read it later, but it works)",
            "https://stackoverflow.com/a/74080156 "
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "poetry new <project name>",
                "cd <project name>",
                "poetry lock",
                "poetry add [list of packages to add]",
                "poetry add --editable <path to editable another python repo>",
                "poetry install # this actually installs the packages into site_packages in a new venv",
                "poetry shell # activate python venv",
                "python3 main.py",
                "exit"
            ]
        },
        "other": [
            "python",
            "poetry"
        ]
    },
    {
        "block": {
            "lang": "rust",
            "code": [
                "// https://ntietz.com/blog/rust-references-vs-pointers/",
                "fn main() {",
                "    let x: u32 = 10;",
                "    let ref_x: &u32 = &x;",
                "    let pointer_x: *const u32 = &x;",
                "    println!(\"x: {x}\");",
                "    println!(\"ref_x: {}\", ref_x);",
                "    println!(\"pointer_x: {:?}\", pointer_x);",
                "}"
            ]
        },
        "other": [
            "rust",
            "a `reference` and `pointer` are not the same thing (i think)"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "# test.py",
                "@pytest.mark.solo",
                "def test_solo(mocker):",
                "    pass",
                "# pytest.ini",
                "[pytest]",
                "markers =",
                "    solo: mark a test as a solo test",
                "pytest -m solo"
            ]
        },
        "other": [
            "pytest",
            "label a test, and run all tests with that label"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "sudo -E foobar"
            ]
        },
        "other": [
            "bash",
            "retain environment variables when using sudo"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "def get_netbox() -> api:",
                "  global nb",
                "  return nb if nb else setup_nb()"
            ]
        },
        "other": [
            "python",
            "learnings for making programs easier to test",
            "1. **never** define top level variables, which at any point require connectivity (ssh, http, etc...). keep them dumb.",
            "2. try consolidate all networking functionality into a class which deals with its lifecycle. make a getter that returns connection objects"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "sudo apt-get install -y make build-essential libssl-dev zlib1g-dev libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm libncurses5-dev libncursesw5-dev xz-utils tk-dev libffi-dev liblzma-dev python3-openssl git libgdbm-dev libnss3-dev",
                "pyenv install 3.11"
            ]
        },
        "other": [
            "pyenv",
            "some libraries required"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "    with stdout_lock or nullcontext():",
                "        logger.info(f\"Polled {hostname} successfully\")"
            ]
        },
        "other": [
            "python",
            "function which might be passed an RLock or None"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "docker builder prune"
            ]
        },
        "other": [
            "docker",
            "docker build creates cache, which can add up"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "class A:",
                "    def __init__(self):",
                "        print(\"A.__init__\")",
                "class B:",
                "    def __init__(self):",
                "        print(\"B.__init__\")",
                "class AB(A, B): ...",
                "    ",
                "ab = AB()",
                "# > A.__init__"
            ]
        },
        "other": [
            "python ",
            "when extending multiple classes, the functions of the first class takes precedence"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "    children_list = [",
                "        *list(mock_netbox._mock_children.items())",
                "    ]",
                "    all_children_mocks = []",
                "    # import ipdb; ipdb.set_trace()",
                "    while children_list:",
                "        children = children_list.pop()",
                "        print(children)",
                "        all_children_mocks.append(children)",
                "        if (c:=list(children)[1]._mock_children.items()):",
                "            for child in c:",
                "                children_list.append(list(child))"
            ]
        },
        "other": [
            "python",
            "go through all child mocks created (properties of mocks)"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "mypy foo.py > mypy.txt; sed -i -e note:/d' -e '/of \"Logger\"/d' -e '/\\[import-untyped\\]/d' mypy.txt; less mypy.txt "
            ]
        },
        "other": [
            "python",
            "mypy to text with certain logs removed"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "def loading_dots2(end_event: Event, sleep_duration: float = 1 / 4):",
                "    animation = cycle([\"|\", \"/\", \"-\", \"\\\\\"])",
                "    hide_cursor = \"\\033[?25l\"",
                "    show_cursor = \"\\033[?25h\"",
                "    clear_line = \"\\r\\033[K\"",
                "    cursor_to_start_of_line = \"\\r\"",
                "    sys.stdout.write(hide_cursor)",
                "    sys.stdout.flush()",
                "    try:",
                "        while not end_event.is_set():",
                "            sys.stdout.write(hide_cursor)",
                "            sys.stdout.write(clear_line)",
                "            sys.stdout.write(next(animation))",
                "            sys.stdout.write(cursor_to_start_of_line)",
                "            sys.stdout.flush()",
                "            time.sleep(sleep_duration)",
                "    except KeyboardInterrupt:",
                "        pass",
                "    finally:",
                "        sys.stdout.write(clear_line)",
                "        # sys.stdout.write(show_cursor)",
                "        sys.stdout.flush()"
            ]
        },
        "other": [
            "python",
            "1px loading icon with the cursor set to the start of the line. this makes it so when another thread prints to stdout, it will overwrite the loading logo."
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": []
        },
        "other": [
            "python",
            "protocol vs abc",
            "https://medium.com/@pouyahallaj/introduction-1616b3a4a637"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "from typing import cast",
                "a: str | None = \"foo\"",
                "b: str = cast(str, a)"
            ]
        },
        "other": [
            "python",
            "to force typecast use `cast`"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "1\timport logging",
                "2\tfrom abc import ABC",
                "3\timport functools",
                "4\tfrom typing import Callable, TypeVar, ParamSpec, Any",
                "5\tP = ParamSpec(\"P\")",
                "6\tT = TypeVar(\"T\")",
                "7\tlogging.basicConfig(level=logging.DEBUG)",
                "8\tdef calling_function():",
                "9\t    decorator(a=2) # decorator will call `foo`` with wrong parameters, but the main invoker is this function",
                "10\t    ",
                "11\tdef decorator(*args, **kwargs):",
                "12\t    try:",
                "13\t        foo(*args, **kwargs)",
                "14\t    except Exception:",
                "15\t        # the traceback will be printed here, but it will not show that `calling_function` passed the values to `decorator`",
                "16\t        logging.exception(\"An error occurred\")",
                "17\tdef foo():",
                "18\t    pass",
                "19\tcalling_function()"
            ]
        },
        "other": [
            "python",
            "error handling in decorators can be difficult. is there is a try block inside the decorator, and the calling function was passed with incorrect parameters, the traceback only show the try block inside the decorator. the calling function, which called the decorated function with wrong parameters, will not be shown.",
            "the takeaway might be to always raise exceptions in a decorator "
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "f\"{[f'{(s:=sleep_duration)} second', f'{(m:=sleep_duration//60)} minute'][s>=60] + 's'[:m>1 or (s> 1 and m < 1)]}\""
            ]
        },
        "other": [
            "python",
            "use seconds if it's >60 or minutes, and add 's' . uses the fact that `string=\"a\"[:-1]` gives the empty string"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": []
        },
        "other": [
            "python",
            "all try/catch blocks of code, should have a unit test associated with it"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "def foo() -> \"SomeClass\":",
                "    ..."
            ]
        },
        "other": [
            "python",
            "forward declare "
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "mock_workflow_mocker.proxy_configure_mock = types.MethodType(proxy_configure_mock, mock_workflow_mocker)"
            ]
        },
        "other": [
            "python",
            "add a function to an object instance and have it take self"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "from typing import Self",
                "def foo(self) -> Self:",
                "    return self"
            ]
        },
        "other": [
            "python",
            "typing a function that returns `self`"
        ]
    },
    {
        "block": {
            "lang": "css",
            "code": [
                ".foo",
                "  .bar",
                "  .bar2",
                "  .bar3",
                "body{",
                "  background: black;",
                "}",
                "div{ width: 100px; height: 100px; border: 1px solid white;}",
                ".foo{",
                "  width: 80%;",
                "  display: flex;",
                "  position: relative; /* this is crucial! default is `static` _not_ `relative` */",
                "}",
                ".bar{",
                "  background: lightgrey;",
                "  position: absolute;",
                "  right: 0;",
                "}"
            ]
        },
        "other": [
            "css",
            "position a `position: absolute` element inside a `relative`"
        ]
    },
    {
        "block": {
            "lang": "vue",
            "code": [
                "<script setup>",
                "  const classes = ref({",
                "    fadeIn: false,",
                "    fadeOut: false,",
                "  });",
                "  const elem = ref(null);",
                "  const opacityValue = ref(0.0);",
                "  ",
                "  function enter() {",
                "    classes.value.animationPause = true;",
                "    classes.value.fadeOut = false",
                "    opacityValue.value = getCurrentOpacity();;",
                "    classes.value.fadeIn = false;",
                "    classes.value.fadeIn = true;",
                "    classes.value.animationPause = false;",
                "  }",
                "  function leave() {",
                "    classes.value.animationPause = true;",
                "    classes.value.fadeIn = false;",
                "    opacityValue.value = getCurrentOpacity();",
                "    classes.value.fadeOut = false;",
                "    classes.value.fadeOut = true;",
                "    classes.value.animationPause = false;",
                "  }",
                "  function getCurrentOpacity() {",
                "    let elem = elem.value as unknown as HTMLElement;",
                "    let elem_styles = window.getComputedStyle(elem);",
                "    return parseFloat(elem_styles.opacity)",
                "  }",
                "</script>",
                "<template>",
                "  <div ",
                "    @mouseenter=\"e => enter()}\"",
                "    @mouseleave=\"e => leave()\"",
                "    :class=\"classes\"",
                "    :ref=\"elem\"",
                "  >",
                "  </div>",
                "</template>",
                "<style>",
                "div {",
                "  opacity: 0;",
                "}",
                ".fadeIn {",
                "  animation: fade-in 0.5s;",
                "  animation-fill-mode: forwards;",
                "}",
                ".fadeOut {",
                "  animation: fade-out 0.5s;",
                "  animation-fill-mode: forwards;",
                "}",
                ".animationPause{",
                "  animation-play-state: paused;",
                "}",
                "@keyframes fade-in {",
                "  from {",
                "    opacity: v-bind(\"opacityValue\")",
                "  }",
                "  to {",
                "    opacity:1;",
                "  }",
                "}",
                "@keyframes fade-out {",
                "  from {",
                "    opacity: v-bind(\"opacityValue\");",
                "  }",
                "  to {",
                "    opacity: 0;",
                "  }",
                "}",
                "</style>"
            ]
        },
        "other": [
            "vue",
            "smooth fade animation that doesn't snap between transitions"
        ]
    },
    {
        "block": {
            "lang": "linux",
            "code": [
                "https://superuser.com/a/156215",
                "x - extract files",
                "c - create archive",
                "t - list files",
                "v - verbose (list files as it processes them)",
                "j - use bz2 compression",
                "z - use gz compression",
                "f - read or write files to disk",
                "Examples",
                "Uncompress a tar.gz file: tar zxf tarball.tar.gz",
                "Uncompress a tar.bz2 file: tar jxf tarball.tar.bz2",
                "Create a tar.gz file: tar zcvf tarvall.tar.gz mydir/*"
            ]
        },
        "other": [
            "linux",
            "tar switches"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "cue eval schema.cue --out json"
            ]
        },
        "other": [
            "cue ",
            "output cue file to json"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "# apt install pipx",
                "# pipx install sqlfluff",
                "sqlfluff lint --dialect postgres schema.ql"
            ]
        },
        "other": [
            "sql",
            "lint sql"
        ]
    },
    {
        "block": {
            "lang": "golang",
            "code": []
        },
        "other": [
            "go",
            "`struct`s cannot be `const` because they're inherently composite types"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "t: Task = asyncio.create_task(foo())",
                "# for async tasks only because non-async tasks just crash the whole event loop",
                "async def foo():",
                "  # use try/except here to error handle",
                "  try:",
                "    function_that_errors()",
                "  except Exception as e:",
                "    logging.exception(e)"
            ]
        },
        "other": [
            "python",
            "correct way to error handle an **async** Task, scheduled with `asyncio.create_task`. don't use `asyncio.add_done_callback(cb)` because it will not  properly capture the traceback when getting the error with `def cb(task): ... task.exception()`(for some reason idk)"
        ]
    },
    {
        "block": {
            "lang": "Microsoft Tunnels",
            "code": [
                "wget -O vscode_cli.tar.gz 'https://code.visualstudio.com/sha/download?build=stable&os=cli-alpine-x64' && tar -xzf vscode_cli.tar.gz -C /opt",
                "chmod +x /opt/code",
                "cd opt",
                "./code tunnel",
                "# install Microsoft: Tunnels",
                "# Remote-Tunnels: Connect to Tunnel"
            ]
        },
        "other": [
            "Microsoft Tunnels",
            "steps to install tunnels"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "if test -d cisco_bindings; then echo exists; else echo does not; fi"
            ]
        },
        "other": [
            "bash",
            "check if a folder exists using the `test` commands"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "> pyenv versions",
                "  system",
                "* 3.11.9 (set by /root/.pyenv/version)",
                "> pyenv global 3.11.9"
            ]
        },
        "other": [
            "pyenv",
            "set global python version "
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "apt-get install locales",
                "localedef -i en_US -f UTF-8 en_US.UTF-8",
                "apt install curl",
                "curl https://pyenv.run | ",
                "for file in .bash_profile .profile .bashrc; do",
                "    echo 'export PYENV_ROOT=\"$HOME/.pyenv\"' >> ~/$file",
                "    echo '[[ -d $PYENV_ROOT/bin ]] && export PATH=\"$PYENV_ROOT/bin:$PATH\"' >> ~/$file",
                "    echo 'eval \"$(pyenv init -)\"' >> ~/$file",
                "done",
                "echo 'eval \"$(pyenv virtualenv-init -)\"' >> ~/.bashrc",
                "apt-get install -y make build-essential libssl-dev zlib1g-dev libbz2-dev libreadline-dev libsqlite3-dev wget curl llvm libncurses5-dev libncursesw5-dev xz-utils tk-dev libffi-dev liblzma-dev python3-openssl git libgdbm-dev libnss3-dev",
                "pyenv install 3.11",
                "# restart shell",
                "bash",
                "pyenv global 3.11.9",
                "python -m pip install --user pipx",
                "python -m pipx ensurepath",
                "python -m pipx completions",
                "eval \"$(register-python-argcomplete pipx)\"",
                "# restart shell",
                "bash",
                "pipx install poetry"
            ]
        },
        "other": [
            "python env",
            "script to install `pyenv` to install `python` to install `pipx` to install `poetry` ..."
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "pytest -s ./tests/test_exception_handlers.py::test_exception_handler"
            ]
        },
        "other": [
            "python",
            "run a specific `pytest` (with stdout collection)"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "# poetry.toml",
                "[virtualenvs]",
                "in-project = true",
                "# OR",
                "# locally",
                "poetry config virtualenvs.in-project true --local",
                "# OR ",
                "# globally",
                "poetry config virtualenvs.in-project true"
            ]
        },
        "other": [
            "python",
            "poetry make venv locally"
        ]
    },
    {
        "block": {
            "lang": "# organise later",
            "code": [
                "# get current deployment config",
                "kubectl get deployment osnal2 n osna -o yaml > deployment.yaml",
                "# patch deployment",
                "kubectl apply -f  deployment.yaml ",
                "# push to pod",
                "kubectl cp \"/home/ubuntu/osna/osna-l2-main/osna-l2/producer.py\" \"osna/osnal2-f458bd694-hl4tj:/app\"",
                "kubectl cp \"/home/ubuntu/osna/osna-l2-main/osna-l2\" \"osna/$(kubectl get pods | grep l2 | awk '{print $1}'):/app\"",
                "# kill all BASH processes except current",
                "ps -C bash -o pid= | grep -v \"^ *$$\" | xargs kill -9 ",
                "# poetry image",
                "## Dockerfile",
                "from python:3.11-slim",
                "env PATH=\"/root/.local/bin:${PATH}\"",
                "run bash -c \"pip install --user pipx && \\",
                "    pipx ensurepath && \\",
                "    pipx completions && \\",
                "    pipx install poetry\"",
                "## docker-compose.yaml",
                "services:",
                "  python-poetry:",
                "    build:",
                "      context: .",
                "      dockerfile: Dockerfile",
                "    image: python-poetry:latest"
            ]
        },
        "other": [
            "# organise later"
        ]
    },
    {
        "block": {
            "lang": "# misc",
            "code": [
                "-net::ERR_BLOCKED_BY_CLIENT"
            ]
        },
        "other": [
            "# misc",
            "## devtools",
            "hide error in dev tools window"
        ]
    },
    {
        "block": {
            "lang": "# svelte",
            "code": [
                "npm create vite@latest",
                "npm i --save-dev @tsconfig/svelte",
                "./tsconfig.node.json: $.compilerOptions.noEmit > $.compilerOptions.emitDeclarationOnly // https://stackoverflow.com/a/77369498"
            ]
        },
        "other": [
            "# svelte",
            "spa"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "jobs",
                "> [1]+  Running                 poetry run main &",
                "kill -9 %1",
                "> [1]+  Killed                  poetry run main"
            ]
        },
        "other": [
            "linux",
            "kill a proc in `jobs` using `%` syntax"
        ]
    },
    {
        "block": {
            "lang": "node",
            "code": [
                "npx tsc"
            ]
        },
        "other": [
            "node",
            "run node tools from cli"
        ]
    },
    {
        "block": {
            "lang": "typescript",
            "code": [
                "x&1 ^ y&1 ? true : false",
                "/***",
                "x&1 -> odd or even row/column",
                "y&1 -> odd of even square",
                "x&1 0 0 1 1 ",
                "y&1 0 1 0 1",
                "XOR 0 1 1 0",
                "the first cell of an odd row, must be the same as the first cell of an even row, for a chequered pattern.",
                "0 1 0 1",
                "1 0 1 0",
                "***/"
            ]
        },
        "other": [
            "misc",
            "alternate values like the squares on a chess board, if you have indices for x + y (row and column)"
        ]
    },
    {
        "block": {
            "lang": "typescript",
            "code": [
                "function identify<Type>(arg: unknown, field: string): arg is Type {",
                "    return (arg as any)[field] !== undefined;",
                "}",
                "identify<Piece>(square, \"piece_type\")"
            ]
        },
        "other": [
            "typescript",
            "dynamic (hacky??) type guard"
        ]
    },
    {
        "block": {
            "lang": "css",
            "code": [
                "body{",
                "    max-height: 99vh;",
                "}"
            ]
        },
        "other": [
            "css",
            "prevent an element from exceeding the screen and ever overflowing"
        ]
    },
    {
        "block": {
            "lang": "svelte",
            "code": [
                "{@const square: Piece | Empty = g.get(...}",
                "{@const marked = !isPiece(square) ? square.is_marked() : null}",
                "<div class=\"{marked ? 'marked' : null}\"></div>"
            ]
        },
        "other": [
            "svelte",
            "use `{@const}` to create in-template variables, also works with reactive states (but you cannot create reactive states i.e. $state rune, in the directive"
        ]
    },
    {
        "block": {
            "lang": "typescript",
            "code": [
                "<div id=\"foo\"> ",
                "  <p>foo</p>",
                "</div>",
                "<div id=\"bar\">",
                "  <p>bar</p>",
                "</div>",
                "#foo{",
                "  position: absolute;",
                "  background: red;",
                "  width: 100px;",
                "  height: 100px;",
                "  left: 50px;",
                "  top: 50px;",
                "  color: black;",
                "  text-align: right;",
                "}",
                "#bar{",
                "  position: absolute;",
                "  background: blue;",
                "  width: 100px;",
                "  height: 100px;",
                "  color: white;",
                "  text-align: right;",
                "  pointer-events: none; /* click + hover are disabled for this */",
                "}",
                "let foo = document.getElementById(\"foo\") as HTMLElement;",
                "let bar = document.getElementById(\"bar\") as HTMLElement;",
                "foo.addEventListener(\"mouseover\", e => console.log(\"foo hover\")});",
                "foo.addEventListener(\"click\", e => console.log(\"foo click\")});",
                "bar.addEventListener(\"mouseover\", e => console.log(\"bar hover\")});",
                "bar.addEventListener(\"click\", e => console.log(\"bar click\")});"
            ]
        },
        "other": [
            "css",
            "use `pointer-events: none` to disable mouse events of an element. can be useful when two elements are stacked on top of each other, and you want to allow the events of the element beneath through"
        ]
    },
    {
        "block": {
            "lang": "batch",
            "code": [
                "keytool -list -v -keystore C:\\Users\\%USERNAME%\\.android\\debug.keystore -alias androiddebugkey -storepass android -keypass android"
            ]
        },
        "other": [
            "android",
            "get the SHA1 signature"
        ]
    },
    {
        "block": {
            "lang": "kotlin",
            "code": [
                "import androidx.compose.runtime.getValue",
                "// ...",
                "val navTarget by navVM.navTarget.collectAsState(initial = \"home\")",
                "// without getValue import: ",
                "// Type 'androidx. compose. runtime. State<kotlin. Any?>' has no method 'getValue(Nothing?, KProperty0<*>)', so it cannot serve as a delegate."
            ]
        },
        "other": [
            "android",
            "when using `by` for property delegation with `collectAsState`, there will be an error unless you import `import androidx.compose.runtime.getValue`"
        ]
    },
    {
        "block": {
            "lang": "kotlin",
            "code": [
                "// typescript -> if (isTypeFoo()) doFooStuf()",
                "// kotlin:",
                "foo?.let { doFooStuff() }"
            ]
        },
        "other": [
            "kotlin",
            "null saftey expression"
        ]
    },
    {
        "block": {
            "lang": "typescript",
            "code": [
                "class Foo{",
                "    public foobar = function(this: Bar){",
                "        this.print_bar() // ts understands `this` is typeof Bar",
                "    }.bind(new Bar())",
                "}",
                "const foo = new Foo()",
                "foo.foobar()",
                "// -> \"bar\""
            ]
        },
        "other": [
            "typescript",
            "`this` can be typehinted in the function signature, useful when using with `bind`"
        ]
    },
    {
        "block": {
            "lang": "svelte",
            "code": [
                "# run in project",
                "npx sv add vitest",
                "mv test src/"
            ]
        },
        "other": [
            "svelte",
            "getting vitest set up (fucking pita)"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "async def SSEStream(request: HttpRequest):",
                "    async def stream():",
                "        _cached_count = None",
                "        while True:",
                "            _cached_count = count",
                "            yield (",
                "                'event: event name'",
                "                '\\n'",
                "                f'data: data'",
                "                '\\n\\n' # <- must be 2 new lines to end a message",
                "            )",
                "        await sleep(1.0)",
                "    return StreamingHttpResponse(stream(), content_type='text/event-stream')",
                "# usage: urls.py",
                "urlpatterns =  [path('stream', SSEStream, name='stream')]"
            ]
        },
        "other": [
            "python",
            "server event stream in django"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "# channels example",
                "$ python3 manage.py shell",
                "import channels.layers",
                "channel_layer = channels.layers.get_channel_layer()",
                "from asgiref.sync import async_to_sync",
                "async_to_sync(channel_layer.send)('test_channel', {'type': 'hello'})",
                "async_to_sync(channel_layer.receive)('test_channel')",
                "{'type': 'hello'}"
            ]
        },
        "other": [
            "python",
            "django interactive shell"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "import sys",
                "from unittest.mock import MagicMock",
                "mod = None",
                "missing_mod = False",
                "while missing_mod:",
                "    if mod:",
                "        print(\"Adding: \" + mod)",
                "        sys.modules[mod] = MagicMock()",
                "        mod = False",
                "    try:",
                "        # import lines go here",
                "    except ModuleNotFoundError as e:",
                "        mod = e.msg.split(\" \")[3].translate(str.maketrans('','','\";\\''))",
                "        print(\"Missing: \" + mod)",
                "        missing_mod = True",
                "        # input(\"> \")",
                "# sys.exit(0)",
                "# resume rest of the code"
            ]
        },
        "other": [
            "python",
            "mock all missing imports dynamically"
        ]
    },
    {
        "block": {
            "lang": "bash",
            "code": [
                "poetry add -D black ruff pylint isort",
                "set FILE=config.py && isort %FILE%  && black %FILE% && ruff check %FILE% --fix  && mypy %FILE%"
            ]
        },
        "other": [
            "python",
            "lint + formatting"
        ]
    },
    {
        "block": {
            "lang": "css",
            "code": [
                "background:",
                "\tvar(--noise), /* url(\"noise svg here\") */",
                "\tradial-gradient(circle at center, rgb(255,255,255) 0%, rgba(0,0,0,1) 50%);",
                "background-size: cover;\t",
                "background-blend-mode: multiply;",
                "mix-blend-mode: screen;"
            ]
        },
        "other": [
            "css",
            "feathered clipping mask"
        ]
    },
    {
        "block": {
            "lang": "python",
            "code": [
                "import logging",
                "from rich.logging import RichHandler",
                "logging.basicConfig(level=logging.INFO)",
                "logger = logging.getLogger(\"app\")",
                "logger.handlers = [RichHandler(rich_tracebacks=True)]",
                "logger.level = logging.DEBUG",
                "logger.propagate = False"
            ]
        },
        "other": [
            "python",
            "rich logger"
        ]
    },
    {
        "block": {
            "lang": "web",
            "code": []
        },
        "other": [
            "web",
            "using `filter` encapsulates a `position:fixed` object in a block, making its position **relative** to that invisible block, and **not relative to the window**",
            "https://stackoverflow.com/a/52937920"
        ]
    }
]